# DigitalOcean Deployment Guide - Tough Love Massage

## 🚀 Quick Deploy (5 Minutes)

### Prerequisites
- DigitalOcean account (sign up at https://digitalocean.com)
- GitHub account
- Your code pushed to GitHub

---

## Step 1: Push to GitHub

```bash
# Initialize git (if not already done)
git init
git add .
git commit -m "Ready for DigitalOcean deployment"

# Create a new repo on GitHub, then:
git remote add origin https://github.com/YOUR_USERNAME/tough-love-massage.git
git branch -M main
git push -u origin main
```

---

## Step 2: Create App on DigitalOcean

1. **Go to**: https://cloud.digitalocean.com/apps
2. **Click**: "Create App"
3. **Choose**: GitHub as source
4. **Authorize**: DigitalOcean to access your GitHub
5. **Select**: Your repository and `main` branch
6. **Auto-detect**: DigitalOcean will detect Python/Flask

---

## Step 3: Configure Database

### Option A: Use Your Existing Neon Database (Recommended)

In the DigitalOcean dashboard, skip the managed database and instead add these environment variables:

```
PGHOST=ep-dry-mountain-ahf1w5m1-pooler.c-3.us-east-1.aws.neon.tech
PGUSER=neondb_owner
PGDATABASE=neondb
PGPASSWORD=npg_MeB9OzuSitI0
PGPORT=5432
DATABASE_URL=postgresql://neondb_owner:npg_MeB9OzuSitI0@ep-dry-mountain-ahf1w5m1-pooler.c-3.us-east-1.aws.neon.tech/neondb?sslmode=require
```

### Option B: Use DigitalOcean Managed PostgreSQL

1. During setup, choose "Add a Database"
2. Select PostgreSQL
3. DigitalOcean will automatically inject connection variables
4. **Cost**: $15/month for managed database

---

## Step 4: Add Environment Variables

In the App Settings → Environment Variables, add:

**Required:**
```
SESSION_SECRET=<generate-random-32-char-string>
ADMIN_EMAIL=your-email@example.com
ADMIN_PASSWORD=your-secure-password
```

**Optional (Email Notifications):**
```
SMTP_SERVER=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password
```

**Optional (Gift Cards):**
```
STRIPE_SECRET_KEY=sk_live_...
```

---

## Step 5: Configure App Settings

1. **Build Command**: `pip install -r requirements.txt`
2. **Run Command**: `gunicorn --bind 0.0.0.0:8080 --reuse-port --workers 4 main:app`
3. **HTTP Port**: `8080`
4. **Instance Size**: Basic (512MB RAM) - $5/month
5. **Region**: Choose closest to your users (NYC recommended)

---

## Step 6: Deploy!

1. **Review**: Check all settings
2. **Click**: "Create Resources"
3. **Wait**: 5-10 minutes for first deployment
4. **Done**: You'll get a URL like `tough-love-massage-xxxxx.ondigitalocean.app`

---

## 📊 Pricing Breakdown

### Recommended Setup:
- **App (Basic)**: $5/month (512MB RAM, 1 vCPU)
- **Database**: $0 (use existing Neon) or $15/month (DO managed)
- **Bandwidth**: 1TB included
- **Total**: **$5/month** with Neon DB

### Scaling Options:
- **Professional**: $12/month (1GB RAM)
- **Pro**: $24/month (2GB RAM)
- **Auto-scaling**: Enable for traffic spikes

---

## 🔒 Security Checklist

Before going live:

- [ ] Set SESSION_SECRET (32+ random characters)
- [ ] Set strong ADMIN_PASSWORD
- [ ] Configure SMTP for email notifications
- [ ] Enable HTTPS (automatic on DigitalOcean)
- [ ] Test all environment variables
- [ ] Review database connection (Neon SSL enabled)
- [ ] Add custom domain (optional)

---

## 🌐 Custom Domain Setup

1. **In DigitalOcean**:
   - Go to App Settings → Domains
   - Click "Add Domain"
   - Enter: `toughlovemassage.com` and `www.toughlovemassage.com`

2. **In Your Domain Registrar** (GoDaddy, Namecheap, etc.):
   - Add CNAME record: `www` → `tough-love-massage-xxxxx.ondigitalocean.app`
   - Add A record: `@` → DigitalOcean IP (provided in dashboard)

3. **SSL Certificate**: Automatic (Let's Encrypt)

---

## 🔄 Continuous Deployment

Auto-deploy on every push:

```bash
# Make changes
git add .
git commit -m "Updated features"
git push origin main

# DigitalOcean automatically:
# 1. Detects push
# 2. Runs build
# 3. Deploys new version
# 4. Zero-downtime rollout
```

---

## 📈 Post-Deployment

### Monitor Your App:
- **Logs**: Real-time in DigitalOcean dashboard
- **Metrics**: CPU, Memory, Response times
- **Alerts**: Set up email notifications
- **Scaling**: One-click resource upgrades

### Test Everything:
1. Visit your live URL
2. Test Worcester/Holliston location pages
3. Test provider portal login
4. Test gift card purchases (if Stripe configured)
5. Check FullSlate booking integration
6. Verify mobile responsiveness

---

## 🆘 Troubleshooting

### Build Fails?
```bash
# Check requirements.txt is up to date
uv pip freeze > requirements.txt
git add requirements.txt
git commit -m "Update requirements"
git push
```

### Database Connection Issues?
- Verify DATABASE_URL format
- Check Neon database allows external connections
- Ensure `sslmode=require` is in connection string

### App Crashes?
- Check runtime logs in DigitalOcean dashboard
- Verify all required environment variables are set
- Ensure Gunicorn command is correct

---

## ✅ Deployment Checklist

- [ ] Code pushed to GitHub
- [ ] App created on DigitalOcean
- [ ] Environment variables configured
- [ ] Database connected (Neon or DO managed)
- [ ] Build & run commands verified
- [ ] First deployment successful
- [ ] Custom domain added (optional)
- [ ] SSL enabled (automatic)
- [ ] Provider account created
- [ ] Sample data loaded (optional)
- [ ] All features tested

---

## 🎉 You're Live!

Your luxury spa website is now running in production on DigitalOcean!

**Next Steps:**
1. Share your live URL with your team
2. Create provider accounts
3. Add real client data
4. Configure FullSlate booking
5. Set up email notifications
6. Launch marketing!

**Support:**
- DigitalOcean Docs: https://docs.digitalocean.com/products/app-platform/
- Community: https://www.digitalocean.com/community/

---

**Happy Deploying! 🚀**
